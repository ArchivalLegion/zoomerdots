#!/bin/sh
#
# VAAPI h264 and aac

ffmpeg -y \
-thread_queue_size 512 -probesize 32M -f pulse -sample_rate 44100 -i default \
-thread_queue_size 512 -probesize 32M -device /dev/dri/card0 -f kmsgrab -i - \
-vf 'hwmap=derive_device=vaapi,scale_vaapi=format=nv12' \
-c:v h264_vaapi -rc_mode:v CBR -compression_level:v 0 -b:v 2500k  \
-c:a aac -profile:a aac_main -aac_coder twoloop -q:a 1 \
~/Videos/recs/screen1_recording_`date '+%m-%d-%Y_%H-%M-%S'`.mkv \
&> ~/Videos/recs/screen1_recording_`date '+%m-%d-%Y_%H-%M-%S'`.log
